window.bioEp={bgEl:{},popupEls:[],closeBtnEl:{},sessonOpens:{},shown:false,overflowDefault:"visible",transformDefault:"",autoOpen:1,width:400,height:220,html:"",css:"",fonts:[],delay:0,showOnDelay:false,cookieExp:30,showOncePerSession:false,onPopup:null,timerOne:null,cookieManager:{create:function(name,value,days,sessionOnly){var expires="";if(sessionOnly){expires="; expires=0";}else{if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}}document.cookie=name+"="+value+expires+"; path=/";},get:function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length);}if(c.indexOf(nameEQ)===0){return c.substring(nameEQ.length,c.length);}}return null;},erase:function(name){this.create(name,"",-1);}},checkCookie:function(){if(this.cookieExp<=0){if(this.showOncePerSession&&this.cookieManager.get("bioep_shown_session")=="true"){return true;}this.cookieManager.erase("bioep_shown");return false;}if(this.cookieManager.get("bioep_shown")=="true"){return true;}return false;},addCSS:function(){for(var i=0;i<this.fonts.length;i++){var font=document.createElement("link");font.href=this.fonts[i];font.type="text/css";font.rel="stylesheet";document.head.appendChild(font);}var css=document.createTextNode(this.css);var style=document.createElement("style");style.type="text/css";style.appendChild(css);document.head.insertBefore(style,document.getElementsByTagName("style")[0]);},addPopup:function(){this.bgEl=document.getElementById("bio_ep_bg");var divs=document.querySelectorAll(".bio_ep"),i;if(divs){for(i=0;i<divs.length;++i){this.popupEls[divs[i].dataset.popup]=divs[i];}}for(key in this.popupEls){this.closeBtnEl=document.createElement("div");this.closeBtnEl.innerHTML='<i class="uka-close" aria-hidden="true" data-key="'+key+'"></i>';this.closeBtnEl.className="bio_ep_close";this.popupEls[key].insertBefore(this.closeBtnEl,this.popupEls[key].firstChild);if(this.popupEls[key].dataset.timeout){if(parseInt(this.popupEls[key].dataset.timeout)>1){this.timerOne=key;setTimeout(function(){bioEp.showPopup(bioEp.timerOne);},parseInt(bioEp.popupEls[bioEp.timerOne].dataset.timeout));}}}},hasClass:function(element,cls){return(" "+element.className+" ").indexOf(" "+cls+" ")>-1;},isVisible:function(elem){if(!(elem instanceof Element)){throw Error("DomUtil: elem is not an element.");}const style=getComputedStyle(elem);if(style.display==="none"){return false;}if(style.visibility!=="visible"){return false;}if(style.opacity<0.1){return false;}if(elem.offsetWidth+elem.offsetHeight+elem.getBoundingClientRect().height+elem.getBoundingClientRect().width===0){return false;}const elemCenter={x:elem.getBoundingClientRect().left+elem.offsetWidth/2,y:elem.getBoundingClientRect().top+elem.offsetHeight/2};if(elemCenter.x<0){return false;}if(elemCenter.x>(document.documentElement.clientWidth||window.innerWidth)){return false;}if(elemCenter.y<0){return false;}if(elemCenter.y>(document.documentElement.clientHeight||window.innerHeight)){return false;}let pointContainer=document.elementFromPoint(elemCenter.x,elemCenter.y);do{if(pointContainer===elem){return true;}}while(pointContainer=pointContainer.parentNode);return false;},fadeIn:function(elem){var go=function(i){setTimeout(function(){elem.style.opacity=i;},i*1000);};for(i=0;i<=1;i=i+0.01){go(i);}},fadeOut:function(elem){var go=function(i){setTimeout(function(){elem.style.opacity=i;},i*1000);};for(i=1;i<=0;i=i-0.01){go(i);}},showPopup:function(key){if((this.popupEls[key].dataset.disabler=="1")&&(this.shown==true)){return;}if((this.popupEls[key].dataset.session=="1")&&(this.sessonOpens[key]==true)){return;}if((this.popupEls[key].dataset.mobile=="0")&&(screen.width<=640)){return;}var divs=document.querySelectorAll(".bio_ep"),i;if(divs){for(i=0;i<divs.length;++i){if((this.isVisible(divs[i]))&&(key==this.autoOpen)){return;}}}this.sessonOpens[key]=true;this.bgEl.style.visibility="visible";this.bgEl.style.opacity=1;for(i=0;i<this.popupEls.length;++i){if(this.popupEls[i]){if(i==key){this.popupEls[i].style.visibility="visible";this.popupEls[i].style.opacity=1;this.centerPopup(i);}else{this.popupEls[i].style.visibility="hidden";this.popupEls[i].style.opacity=0;}}}this.shown=true;this.cookieManager.create("bioep_shown","true",this.cookieExp,false);this.cookieManager.create("bioep_shown_session","true",0,true);if(typeof this.onPopup==="function"){this.onPopup();}},centerPopup:function(key){var w=this.popupEls[key].offsetWidth;var h=this.popupEls[key].offsetHeight;console.log(w);console.log(h);var dualScreenLeft=window.screenLeft!=undefined?window.screenLeft:screen.left;var dualScreenTop=window.screenTop!=undefined?window.screenTop:screen.top;var width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var left=((width/2)-(w/2))+dualScreenLeft;var top=((height/2)-(h/2))+dualScreenTop;console.log(left);console.log(top);this.popupEls[key].style.left=left+"px";this.popupEls[key].style.top=top+"px";},hidePopup:function(key){console.log("CLOSE:"+key);this.bgEl.style.visibility="hidden";this.bgEl.style.opacity=0;this.popupEls[key].style.visibility="hidden";this.popupEls[key].style.opacity=0;},addEvent:function(obj,event,callback){if(obj.addEventListener){obj.addEventListener(event,callback,false);}else{if(obj.attachEvent){obj.attachEvent("on"+event,callback);}}},loadCloseEvents:function(){var closings=document.querySelectorAll(".bio_ep_close"),i;if(closings){for(i=0;i<closings.length;++i){this.addEvent(closings[i],"click",function(e){bioEp.hidePopup(e.target.dataset.key);});}}},loadEvents:function(){this.addEvent(document,"mouseout",function(e){e=e?e:window.event;if(e.target.tagName.toLowerCase()=="input"){return;}var vpWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0);if(e.clientX>=(vpWidth-50)){return;}if(e.clientY>=50){return;}var from=e.relatedTarget||e.toElement;if(!from){bioEp.showPopup(this.autoOpen);}}.bind(this));this.addEvent(window,"resize",function(){for(i=0;i<bioEp.popupEls.length;++i){if(bioEp.popupEls[i]){bioEp.centerPopup(i);}}});},setOptions:function(opts){this.width=(typeof opts.width==="undefined")?this.width:opts.width;this.height=(typeof opts.height==="undefined")?this.height:opts.height;this.html=(typeof opts.html==="undefined")?this.html:opts.html;this.css=(typeof opts.css==="undefined")?this.css:opts.css;this.fonts=(typeof opts.fonts==="undefined")?this.fonts:opts.fonts;this.delay=(typeof opts.delay==="undefined")?this.delay:opts.delay;this.showOnDelay=(typeof opts.showOnDelay==="undefined")?this.showOnDelay:opts.showOnDelay;this.cookieExp=(typeof opts.cookieExp==="undefined")?this.cookieExp:opts.cookieExp;this.autoOpen=(typeof opts.autoOpen==="undefined")?this.autoOpen:opts.autoOpen;this.showOncePerSession=(typeof opts.showOncePerSession==="undefined")?this.showOncePerSession:opts.showOncePerSession;this.onPopup=(typeof opts.onPopup==="undefined")?this.onPopup:opts.onPopup;},domReady:function(callback){(document.readyState==="interactive"||document.readyState==="complete")?callback():this.addEvent(document,"DOMContentLoaded",callback);},init:function(opts){if(typeof opts!=="undefined"){this.setOptions(opts);}this.addCSS();this.domReady(function(){if(bioEp.checkCookie()){return;}bioEp.addPopup();bioEp.loadCloseEvents();setTimeout(function(){bioEp.loadEvents();if(bioEp.showOnDelay){bioEp.showPopup(this.autoOpen);}},bioEp.delay*1000);});}};